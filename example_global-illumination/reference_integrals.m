%%%%%%%%
%%      This sciprt computes reference values for global illumination integrals 
%%      using standard Monte Carlo integration.
%%
%%  Toni Karvonen, 2018
%%%%%%%%

  clear all
  close all

  % Addpaths
  addpath('../functions/')
  
  % Basic integrand parameters
  ang = linspace(pi/4-pi/24,pi/4+pi/24,50);
  D = length(ang);

  % Reference integral values
  ref_ints = zeros(D,3);
  N = 1e7; % Number of MC samples per integrand
  for col = 1:3
    for i = 1:D
      tmp = randn(3,N);
      X = tmp./sqrt(sum(tmp.^2));
      Y = evaluate_integrand_fast(ang(i),X,col);
      ref_ints(i,col) = sum(Y)/N;
      [col i]
    end
  end
  
  % Save
  save('ref_ints.mat','ref_ints','ang')
