function envMapValue = querryEM(envMap,omega_i)
% This function receives an environment map (EM) and a direction, and returns 
% the EM value (i.e., the radiance) for that same direction
% The input argument 'envMap' should result from using hdrread to read an
% environment map from file.

% Compute the Size of the EM
[mapHeigh, mapWidth] = size(envMap);
maxX = mapWidth/3;
maxY = mapHeigh;

% Get the 2D EM coordinates (in the image plane) corresponding to the spherical direction
[x,y] = get2D_EM_Coordinates(omega_i, maxX, maxY);

% Consult the EM 
envMapValue = reshape(envMap(y, x, :), 1, 3);

% From Ricardo Marques:
% "In rendering we usually work with RGB tuples for red, green and
% blue colors. So basically our L_i function returns a 3D vector. If it is
% more convenient to you to work with a scalar, you can uncomment the
% following code:"
% Convert from RGB to Luminance
% envMapValue = envMapValue * [0.299 0.587 0.114]';

end

