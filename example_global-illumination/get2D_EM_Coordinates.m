function [ x, y ] = get2D_EM_Coordinates( dir, maxX, maxY )
% Get the 2D environment map coordinates (in the image plane) corresponding
% to the spherical direction dir

clamp = @(f, a, b) max(a, min(f, b));

x = 1 + ((maxX-1)*(0.5 * (1.0 + atan2(-dir(1), -dir(3)) / pi)));
y = 1 + ((maxY-1)*(acos( clamp(dir(2), -1.0, 1.0) ) / pi));

x = round(x);
y = round(y);

end

